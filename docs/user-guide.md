# 用户指南

## 🚀 快速开始

### 启动应用

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

访问：http://localhost:5173

---

## 📖 使用流程

### 步骤 1：输入 API 数据

在第一个页面，你需要粘贴两部分数据：

#### 1.1 API 响应样例 JSON（必填）

粘贴一个真实的 API 响应数据，例如：

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "rows": [
      {
        "userId": 1,
        "userName": "张三",
        "phone": "13800138000",
        "status": "active",
        "createTime": "2024-01-01 10:00:00"
      },
      {
        "userId": 2,
        "userName": "李四",
        "phone": "13900139000",
        "status": "inactive",
        "createTime": "2024-01-02 11:00:00"
      }
    ],
    "total": 100
  }
}
```

#### 1.2 请求参数示例 JSON（可选）

粘贴请求参数，用于识别搜索字段和分页参数：

```json
{
  "pageNo": 1,
  "pageSize": 20,
  "userName": "",
  "status": ""
}
```

点击 **"解析并推断"** 按钮。

---

### 步骤 2：查看解析结果

系统会自动识别：
- ✅ 数据数组路径（如：`data.rows`）
- ✅ 总数字段路径（如：`data.total`）
- ✅ 分页参数（如：`pageNo`, `pageSize`）
- ✅ 数据字段列表
- ✅ 搜索条件

**可以做什么**：
- 切换备选路径（如果识别不准确）
- 手动修改分页参数名称
- 查看数据预览

确认无误后，点击 **"下一步：AI 推断"**。

---

### 步骤 3：AI 推断配置

选择推断方式：

#### 方式 1：本地推断（推荐）

- ✅ 快速（< 1 秒）
- ✅ 无需 API Key
- ✅ 适合标准化的 API 结构
- ✅ 免费

直接点击 **"开始推断"**。

#### 方式 2：AI 推断（高级）

如果你的字段命名不规范或需要更智能的推断：

1. 选择 AI Provider（OpenAI / Anthropic）
2. 输入 API Key
3. 点击 **"开始推断"**

**注意**：API Key 仅保存在浏览器本地，不会上传到服务器。

---

### 步骤 4：确认配置

这是最重要的一步！系统会展示推断的配置，你可以：

#### 4.1 表格列配置

- **拖拽排序**：点击左侧拖拽图标调整列顺序
- **显示/隐藏**：勾选复选框控制列的显隐
- **编辑标题**：直接修改列的显示标题
- **修改类型**：选择列类型（文本/日期时间/标签）
- **编辑映射**：为标签类型配置状态映射

**低置信度项**：
- 如果某列的置信度 < 80%，会显示橙色背景
- 建议重点检查这些项

#### 4.2 搜索字段配置

- **添加字段**：点击 "添加搜索字段" 新增
- **删除字段**：点击 "删除" 移除
- **编辑类型**：选择组件类型（输入框/下拉选择/日期）
- **配置选项**：为下拉选择配置选项列表

#### 4.3 数据路径配置

- **数据数组路径**：如果识别不准确，可以选择其他路径或手动输入
- **总数字段路径**：同上
- **分页参数**：修改页码和每页条数的参数名

#### 4.4 页面信息

- **页面组件名**：修改 Vue 组件名称（使用 PascalCase）
- **面包屑导航**：添加或删除导航项

---

### 步骤 5：生成代码

确认配置无误后，点击 **"生成代码"** 按钮。

系统会：
1. 校验配置（JSON Schema）
2. 生成 Vue2 代码
3. 格式化代码（Prettier）
4. 校验代码（Vue 模板编译器）

---

### 步骤 6：查看结果

#### 6.1 代码校验结果

- ✅ **通过**：代码可以安全使用
- ❌ **失败**：显示错误列表，需要修正配置

#### 6.2 生成的代码

**Tab 1：Vue 组件代码**
- 完整的 Vue2 单文件组件（SFC）
- 包含 template、script、style
- 已经格式化

**操作**：
- 点击 **"复制代码"** 复制到剪贴板
- 点击 **"下载文件"** 下载为 `.vue` 文件

**Tab 2：API 服务代码**（可选）
- 如果配置了 API 信息，会生成 API 请求封装代码
- 可以直接复制到项目的 `api/` 目录

**Tab 3：路由配置**（可选）
- 生成路由配置片段
- 可以直接复制到 `router/index.js`

---

## 💡 使用技巧

### 技巧 1：快速测试

使用内置的示例数据快速测试：

1. 在 API 输入页面，点击底部的 **"填充示例 X"** 按钮
2. 系统会自动填充示例数据
3. 直接点击 "解析并推断"

### 技巧 2：处理复杂状态映射

如果你的状态字段有多个值：

1. 生成配置后，进入 **"表格列配置"** Tab
2. 找到状态列，点击 **"编辑映射"**
3. 为每个值配置显示标签和标签类型：
   - `success` (绿色) - 成功/启用/通过
   - `warning` (橙色) - 警告/待处理
   - `danger` (红色) - 失败/错误
   - `info` (灰色) - 信息/停用
   - `primary` (蓝色) - 主要/默认

### 技巧 3：自定义搜索字段

如果推断的搜索字段不够：

1. 进入 **"搜索字段配置"** Tab
2. 点击 **"添加搜索字段"**
3. 填写字段名、标签、类型
4. 如果是下拉选择，点击 **"编辑选项"** 配置选项列表

### 技巧 4：保存 AI 配置

如果你经常使用 AI 推断：

1. 首次使用时输入 API Key
2. 系统会自动保存到 localStorage
3. 下次使用时会自动加载

---

## 🔧 常见问题

### Q1：解析失败怎么办？

**原因**：
- JSON 格式不正确
- 响应中没有数组数据

**解决**：
1. 检查 JSON 格式（使用在线 JSON 校验工具）
2. 确保响应中包含数组数据
3. 尝试粘贴更完整的响应数据

---

### Q2：数据路径识别错误怎么办？

**解决**：
1. 在步骤 2 "解析结果" 页面，点击 **"查看备选"**
2. 从备选路径中选择正确的路径
3. 或者手动输入正确的路径

---

### Q3：生成的列标题不准确怎么办？

**解决**：
1. 在步骤 4 "确认配置" 页面
2. 进入 **"表格列配置"** Tab
3. 直接修改每列的 "显示标题"

---

### Q4：需要添加新列怎么办？

**解决**：
1. 在 **"表格列配置"** Tab
2. 点击 **"添加列"** 按钮
3. 填写字段名、标题、类型、宽度

---

### Q5：生成的代码不能直接使用怎么办？

**说明**：
- 生成的代码是标准模板
- 需要根据实际项目调整

**常见调整**：
1. 修改 API 请求方法（如果项目使用封装的 API）
2. 调整样式（如果项目有自定义主题）
3. 添加业务逻辑（如按钮点击事件）

---

### Q6：AI 推断比本地推断好在哪里？

**本地推断**：
- 基于规则推断
- 适合规范的字段命名
- 速度快、免费

**AI 推断**：
- 基于语义理解
- 适合不规范的字段命名
- 可以处理复杂业务术语
- 推断质量更高

**示例**：
```
字段名: usr_nm
本地推断: "Usr Nm"
AI 推断: "用户名称"
```

---

## 📊 支持的 API 结构

### 标准结构

```json
{
  "data": {
    "rows": [...],
    "total": 100
  }
}
```

### 嵌套结构

```json
{
  "result": {
    "list": [...],
    "totalCount": 50
  }
}
```

### 分页信息嵌套

```json
{
  "data": {
    "pagination": {
      "items": [...],
      "total": 200
    }
  }
}
```

### 自定义字段名

支持的变体：
- 数据：`rows` / `list` / `items` / `data` / `records`
- 总数：`total` / `totalCount` / `count` / `totalRecords`
- 页码：`page` / `pageNo` / `pageNum` / `current`
- 每页条数：`pageSize` / `size` / `limit` / `perPage`

---

## 🎯 最佳实践

### 1. 使用真实数据

- ✅ 使用生产环境的真实 API 响应
- ✅ 至少包含 2-3 条数据记录
- ❌ 不要使用空数组或 Mock 数据

### 2. 先快速生成，再调整

- ✅ 使用本地推断快速生成初稿
- ✅ 在确认面板仔细检查
- ✅ 重点关注低置信度项
- ✅ 测试生成的代码

### 3. 善用复制功能

- ✅ 复制组件代码到项目
- ✅ 复制 API 服务代码
- ✅ 复制路由配置
- ✅ 根据项目实际情况调整

### 4. 保持配置简洁

- ✅ 只显示必要的列
- ✅ 搜索字段不要太多（3-5 个为宜）
- ✅ 状态映射保持简单
- ✅ 面包屑层级不要太深（2-3 层）

---

## 📝 配置示例

### 完整的页面配置

```json
{
  "templateId": "standard-list",
  "pageName": "UserList",
  "breadcrumb": ["首页", "系统管理", "用户管理"],
  "dataMapping": {
    "dataPath": "data.rows",
    "totalPath": "data.total",
    "pageNoField": "pageNo",
    "pageSizeField": "pageSize"
  },
  "columns": [
    {
      "prop": "userId",
      "label": "用户ID",
      "type": "text",
      "width": "80",
      "visible": true,
      "confidence": 0.95
    },
    {
      "prop": "userName",
      "label": "用户名称",
      "type": "text",
      "visible": true,
      "confidence": 0.9
    },
    {
      "prop": "status",
      "label": "状态",
      "type": "tag",
      "visible": true,
      "mapping": {
        "active": {
          "label": "启用",
          "type": "success"
        },
        "inactive": {
          "label": "停用",
          "type": "info"
        }
      },
      "confidence": 0.75
    },
    {
      "prop": "createTime",
      "label": "创建时间",
      "type": "datetime",
      "visible": true,
      "confidence": 0.9
    }
  ],
  "searchFields": [
    {
      "prop": "userName",
      "label": "用户名称",
      "type": "input",
      "defaultValue": "",
      "confidence": 0.9
    },
    {
      "prop": "status",
      "label": "状态",
      "type": "select",
      "options": [
        { "label": "全部", "value": "" },
        { "label": "启用", "value": "active" },
        { "label": "停用", "value": "inactive" }
      ],
      "defaultValue": "",
      "confidence": 0.75
    }
  ]
}
```

---

## 🎉 开始使用

现在你已经了解了所有功能，开始使用吧！

1. 启动应用：`npm run dev`
2. 准备你的 API 数据
3. 按照 5 步流程操作
4. 生成代码并使用

祝你使用愉快！🚀

